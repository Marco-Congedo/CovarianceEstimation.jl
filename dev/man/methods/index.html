<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Methods · CovarianceEstimation.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>CovarianceEstimation.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Manual</span><ul><li class="current"><a class="toctext" href>Methods</a><ul class="internal"><li><a class="toctext" href="#Notations-1">Notations</a></li><li><a class="toctext" href="#Simple-estimator-1">Simple estimator</a></li><li><a class="toctext" href="#Linear-shrinkage-estimators-1">Linear shrinkage estimators</a></li><li><a class="toctext" href="#Nonlinear-shrinkage-estimators-1">Nonlinear shrinkage estimators</a></li><li><a class="toctext" href="#Comparing-estimators-1">Comparing estimators</a></li></ul></li><li><a class="toctext" href="../lshrink/">Linear shrinkage estimators</a></li><li><a class="toctext" href="../nlshrink/">Nonlinear shrinkage estimators</a></li><li><a class="toctext" href="../msecomp/">MSE comparisons</a></li></ul></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="../../lib/public/">Public</a></li><li><a class="toctext" href="../../lib/internals/">Internals</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href>Methods</a></li></ul><a class="edit-page" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/master/docs/src/man/methods.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Methods</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Methods-1" href="#Methods-1">Methods</a></h1><h2><a class="nav-anchor" id="Notations-1" href="#Notations-1">Notations</a></h2><p>In these docs, <span>$X$</span> denotes an <span>$n\times p$</span> data matrix describing <span>$n$</span> observations with <span>$p$</span> features (variables) and possibly <span>$p &gt; n$</span>. For most estimators, the matrix is assumed to have entries in <span>$\mathbb R$</span>.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>While in the docs we assume that the rows of <span>$X$</span> correspond to observations and the columns to features, in the code you can specify this using the <code>dims</code> keyword with <code>dims=1</code> being the default whereas <code>dims=2</code> will take rows as features and columns as observations.</p></div></div><p>We will write <span>$X_c$</span> the <em>centered</em> matrix i.e. where each column sums up to zero. We will also write <span>$X_s$</span> the <em>standardised</em> matrix i.e. where each column not only sums up to zero but is scaled to have sample variance one. Finally, we will write <span>$S$</span> the standard sample covariance estimator (see below) of size <span>$p\times p$</span> and <span>$D$</span> the diagonal matrix matching the diagonal of <span>$S$</span>.</p><p>Note that the sample variance and covariance can be corrected or uncorrected (and this can be specified in the code). In order to avoid having to specify this everywhere in the document, it is useful to introduce a last symbol: <span>$\kappa$</span> which is either set to <span>$n$</span> (uncorrected case) or <span>$(n-1)$</span> (corrected case).</p><p>With these notations we can write:</p><div>\[\begin{eqnarray}
    S &amp;=&amp; \kappa^{-1}X_c^T X_c \label{simple-covariance}\\
    D_{ij} &amp;=&amp; S_{ij}\mathbf 1_{[i=j]}\\
    X_s &amp;=&amp; X_c D^{-1/2}
\end{eqnarray}\]</div><h2><a class="nav-anchor" id="Simple-estimator-1" href="#Simple-estimator-1">Simple estimator</a></h2><p>The standard covariance estimator is easily obtained via \eqref{simple-covariance}. It can be specified with the constructor <code>Simple</code> which can take a named argument <code>corrected</code> (either <code>false</code> (default) or <code>true</code>).</p><div><pre><code class="language-julia">Random.seed!(1)
n, p = 5, 7
X = randn(n, p)
# corrected covariance
S = cov(Simple(corrected=true), X)
# we can also manually compute it and compare
Xc = (X .- sum(X, dims=1)/n) # centering
κ = n-1 # correction factor
S ≈ (Xc&#39;*Xc)/κ</code></pre><pre><code class="language-none">true</code></pre></div><h2><a class="nav-anchor" id="Linear-shrinkage-estimators-1" href="#Linear-shrinkage-estimators-1">Linear shrinkage estimators</a></h2><p>Linear shrinkage estimators correspond to covariance estimators of the form</p><div>\[\hat\Sigma = (1-\lambda)S + \lambda F\]</div><p>where <span>$F$</span> is a <em>target</em> matrix of appropriate dimensions, <span>$\lambda\in[0,1]$</span> is a shrinkage intensity and <span>$S$</span> is the sample covariance estimator. There are several standard targets that can be used, a simple example being the identity matrix.</p><p>The shrinkage intensity <span>$\lambda$</span> can be specified manually or computed automatically. Depending on the target, different approaches are implemented to compute a good intensity such as, for example, the Ledoit-Wolf optimal intensity (which is the default intensity if you don&#39;t specify it).</p><p>You can read more on the targets that can be used and the corresponding automatic intensities <a href="../lshrink/#lshrink-1">here</a>.</p><p>Here is an example using the identity matrix as a target and automatic shrinkage intensity (Ledoit-Wolfe):</p><div><pre><code class="language-julia">Random.seed!(1)
n, p = 2, 3
X = randn(n, p)
target = DiagonalUnitVariance()
shrinkage = :lw # Ledoit-Wolf optimal shrinkage
method = LinearShrinkage(target, shrinkage)
cov(method, X)</code></pre><pre><code class="language-none">3×3 Array{Float64,2}:
 0.00181084  0.0124936  0.0244715
 0.0124936   0.0861978  0.168837
 0.0244715   0.168837   0.330704</code></pre></div><p>You can also specify the intensity manually:</p><div><pre><code class="language-julia">shrinkage = 0.8
method2 = LinearShrinkage(target, shrinkage)
cov(method2, X)</code></pre><pre><code class="language-none">3×3 Array{Float64,2}:
 0.800362    0.00249872  0.0048943
 0.00249872  0.81724     0.0337674
 0.0048943   0.0337674   0.866141</code></pre></div><p><a href="../lshrink/#lshrink-1">Read more on linear shrinkage estimators...</a></p><h2><a class="nav-anchor" id="Nonlinear-shrinkage-estimators-1" href="#Nonlinear-shrinkage-estimators-1">Nonlinear shrinkage estimators</a></h2><p><a href="../nlshrink/#nlshrink-1">Read more on nonlinear shrinkage estimators...</a></p><h2><a class="nav-anchor" id="Comparing-estimators-1" href="#Comparing-estimators-1">Comparing estimators</a></h2><p>You may want to look at our simple <a href="../msecomp/#msecomp-1">comparison of covariance estimators</a> which compares the MSE of the various estimators in a range of situations. Long story short, the <code>LinearShrinkageEstimator</code> with <code>DiagonalUnequalVariance</code> target performs well in the case <span>$n&lt;p$</span> though most other estimators don&#39;t fare too badly in comparison. In the case <span>$n&gt;p$</span>, the nonlinear shrinkage method does very well (though it is more expensive to compute).</p><footer><hr/><a class="previous" href="../../"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="../lshrink/"><span class="direction">Next</span><span class="title">Linear shrinkage estimators</span></a></footer></article></body></html>
